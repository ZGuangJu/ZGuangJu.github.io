(window.webpackJsonp=window.webpackJsonp||[]).push([[171],{662:function(t,a,s){"use strict";s.r(a);var e=s(2),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("升级依赖")]),t._v(" "),s("p",[t._v("在构建项目的时候，有时会经常为了将项目或者全局依赖更新到最新版本的情况，这里做个总结。")])]),t._v(" "),s("h2",{attrs:{id:"检查版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检查版本"}},[t._v("#")]),t._v(" 检查版本")]),t._v(" "),s("ul",[s("li",[t._v("查看所有包的更新：")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g outdated\n")])])]),s("ul",[s("li",[t._v("查看单个包的更新版本")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm show "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("packag"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("h2",{attrs:{id:"更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新"}},[t._v("#")]),t._v(" 更新")]),t._v(" "),s("p",[t._v("传统的做法是一个一个更新，比如更新 "),s("code",[t._v("react")]),t._v(" 到最新版本，命令如下")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// npm")]),t._v("\nnpm i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save react@latest\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// yarn")]),t._v("\nyarn add react@latest\n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注")]),t._v(" "),s("p",[s("code",[t._v("yarn")]),t._v(" 是 "),s("code",[t._v("facebook")]),t._v(" 发明的新一代 "),s("code",[t._v("js")]),t._v(" 包管理器，支持离线使用."),s("a",{attrs:{href:"https://classic.yarnpkg.com/zh-Hans/docs/migrating-from-npm",target:"_blank",rel:"noopener noreferrer"}},[t._v("这是 npm 与 yarn 的 命令对照"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("这种做法相当耗时。有没有更简单的方法呢\n当然有："),s("code",[t._v("npm-check")]),t._v(" 和 "),s("code",[t._v("yarn")]),t._v(" ，都需要全局安装")]),t._v(" "),s("h2",{attrs:{id:"npm-check"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#npm-check"}},[t._v("#")]),t._v(" npm-check")]),t._v(" "),s("p",[t._v("安装"),s("code",[t._v("npm-check")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g npm"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("check\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或者")]),t._v("\nyarn add "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g npm"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("check\n")])])]),s("p",[t._v("在项目根目录运行")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("check "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u\n")])])]),s("p",[t._v("输出结果")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" Choose which packages to update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Press "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("space"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" to select"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n Missing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" You probably want these"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" vuepress"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("theme"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("reco missing      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".5")]),t._v("  https"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vuepress"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("theme"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("reco"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recoluan"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("com")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" vuepress devDep missing          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".3")]),t._v("  https"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vuejs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vuepress#readme\n\n Space to select"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Enter to start upgrading"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Control"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),t._v(" to cancel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("空格选中某一项，"),s("code",[t._v("control-c")]),t._v("选中所有，回车开始升级")]),t._v(" "),s("h2",{attrs:{id:"yarn"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#yarn"}},[t._v("#")]),t._v(" yarn")]),t._v(" "),s("ul",[s("li",[t._v("安装yarn")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("npm i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g yarn\n")])])]),s("ul",[s("li",[t._v("项目中升级依赖包")])]),t._v(" "),s("ol",[s("li",[s("code",[t._v("yarn upgrade-interactive --latest")]),t._v("命令（亲测无效，不能更新"),s("code",[t._v("package.json")]),t._v("中的版本，可以更新"),s("code",[t._v("yarn.lock")]),t._v("中的版本）")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("yarn upgrade"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("interactive "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("latest\n")])])]),s("p",[t._v("输出结果")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("info Color legend "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<red>"')]),t._v("    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Major Update backward"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("incompatible updates\n "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<yellow>"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Minor Update backward"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compatible features\n "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<green>"')]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Patch Update backward"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compatible bug fixes\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" Choose which packages to update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n devDependencies\n   name                 range   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("      to     url\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" vuepress             latest  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".2")]),t._v("  ❯  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".3")]),t._v("  https"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vuejs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vuepress#readme\n\n dependencies\n   name                 range   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("      to     "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("url")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" vuepress"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("theme"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("reco  latest  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.4")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".7")]),t._v("  ❯  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".5")]),t._v("  https"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vuepress"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("theme"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("reco"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recoluan"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com\n")])])]),s("p",[t._v("需要手动选择升级的依赖包，按空格键选择，"),s("code",[t._v("a")]),t._v(" 键切换所有，"),s("code",[t._v("i")]),t._v(" 键反选选择")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("指定版本号，这种方法会在 "),s("code",[t._v("package.json")]),t._v(" 文件中限定包的版本")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("yarn upgrade "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("@x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("使用 "),s("code",[t._v("npm-check-updates")]),t._v(" 升级（亲测无效，不能更新"),s("code",[t._v("package.json")]),t._v("中的版本，可以更新"),s("code",[t._v("yarn.lock")]),t._v("中的版本）")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 先下载")]),t._v("\nyarn global add npm"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("check"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("updates\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新包（yarn.lock和package.json同步更新）")]),t._v("\nncu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("upgrade "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("upgradeAll "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" yarn upgrade\n")])])]),s("h2",{attrs:{id:"更新命令对照表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新命令对照表"}},[t._v("#")]),t._v(" 更新命令对照表")]),t._v(" "),s("p",[t._v("更新全局依赖同上")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("说明")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("yarn")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("npm-check")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("更新项目依赖，没有交互")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("yarn upgrade --latest")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("npm-check -y")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("更新项目依赖，有交互")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("yarn upgrade-interactive --latest")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("npm-check -u")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("更新全局依赖，没有交互")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("yarn global upgrade --latest")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("npm-check -g -y")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("更新全局依赖，有交互 yarn global upgrade-interactive --latest npm-check -g -u")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),s("ul",[s("li",[t._v("检测原理\n"),s("code",[t._v("yarn")]),t._v(" 是根据 "),s("code",[t._v("yarn.lock")]),t._v(" 文件来检测版本是否是最新的，所以项目是使用 npm 安装依赖包，更新前要运行 "),s("code",[t._v("yarn")]),t._v(" 这个命令安装 一下。")])]),t._v(" "),s("p",[s("code",[t._v("npm-check")]),t._v(" 是检测 "),s("code",[t._v("package.json")]),t._v(" 文件，项目存在 "),s("code",[t._v("node_modules")]),t._v(" 文件夹即可更新。")]),t._v(" "),s("p",[t._v("更新提醒\n没有交互就是将依赖包直接更新到最新版本，推荐使用交互式更新，会有更新的警告信息。")]),t._v(" "),s("p",[t._v("最新的依赖包，"),s("code",[t._v("API")]),t._v(" 可能发生重大改变。为了顺利更新，更新前请 "),s("code",[t._v("git commit")]),t._v(" 一下，更新失败了也能顺利回退。")]),t._v(" "),s("p",[t._v("不推荐使用 "),s("code",[t._v("cnpm")]),t._v("\n为了加快安装依赖的安装速度，可能被同事安利 "),s("code",[t._v("cnpm")]),t._v("，但是这样会导致包的依赖安装不正常，项目无法运行。")]),t._v(" "),s("p",[t._v("更好的做法是使用 nrm 切换下载源。")]),t._v(" "),s("h2",{attrs:{id:"在vscode中有个插件可以更新包版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在vscode中有个插件可以更新包版本"}},[t._v("#")]),t._v(" 在VScode中有个插件可以更新包版本")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("插件名："),s("code",[t._v("Version Lens")])])]),t._v(" "),s("li",[s("p",[t._v("使用：在编辑器里打开"),s("code",[t._v("package.json")]),t._v("文件,在每个依赖包处都有"),s("code",[t._v("latest")]),t._v("或者"),s("code",[t._v("latest x.x")]),t._v(" 版本，点击版本号或者"),s("code",[t._v("latest")]),t._v("即可更新；如果打开"),s("code",[t._v("package.json")]),t._v("文件无变化，在编辑器右上角找"),s("code",[t._v("V")]),t._v("字的按钮，点击即可打开。")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);